<!doctype html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
  <head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="megakit,business,company,agency,multipurpose,modern,bootstrap4">
  
  <meta name="author" content="themefisher.com">

  <title th:text="'JSLog - ' + ${post.title}">Post</title>

	  <link th:insert="common/csss.html">
	<style>
		.hoUhWW {
			width: 32px;
			height: 32px;
			border-radius: 16px;
			display: flex;
			-webkit-box-align: center;
			align-items: center;
			-webkit-box-pack: center;
			justify-content: center;
			border: 1px solid rgb(32, 201, 151);
			color: rgb(32, 201, 151);
		}
		.post_row{
			display: -ms-flexbox;
			display: flex;
			-ms-flex-wrap: wrap;
			flex-wrap: wrap;
			margin-right: -15px;
			margin-left: -15px;
			flex-direction: column;
    		align-items: center;
		}
		textarea{
			resize: none;
		}
		.buttons-wrapper{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end;}
	</style>
</head>

<body>

	<input type="text" id="getContent" th:value="${post.content}" hidden>
	<!-- Navigation -->
	<nav th:insert="common/navigation.html"></nav>

	<div class="main-wrapper ">
		<section class="section blog-wrap">
			<div class="container">
				<div class="post_row">
					<div class="col-lg-10">
						<div class="row">
							<div class="col-lg-12 mb-5">
								<div class="single-blog-item">
									<!-- Thumbnail
									<img src="/images/blog/2.jpg" alt="" class="img-fluid rounded">
									-->
									<div class="blog-item-content bg-white p-5">
										<!-- Title -->
										<h1 class="mt-3 mb-4" th:text="${post.title}"><a href="blog-single.html"></a></h1>
										<!-- Title End -->

										<hr width="100%">

										<!-- author, created_date, edit_button, delete_button -->
										<div class="blog-item-meta py-1 mb-2">
											<span class="text-black text-capitalize mr-3"><i class="ti-pencil mr-2"></i><i th:text="${post.author.nickname}">작가</i></span>
											<span class="text-muted text-capitalize mr-3"><i class="ti-time mr-1"></i> <span th:text="${post.createdDate}">게시글 생성 날짜</span></span>
											<span th:if="${loginMember} == null" style="display:inline" class="mr-5">
												<i class="ti-heart"></i>
												<span th:text="${post.likesResponse.likes}" class="ml-1">게시글 좋아요 수</span>
											</span>
											<span th:unless="${loginMember} == null" style="display:inline" class="mr-5">
												<a th:if="${post.likesResponse.liked}" th:href="@{/likes/unlike(postId=${post.id}, redirectAuthorId=${post.author.id}, redirectUrl=${post.url})}">♥</a>
												<a th:unless="${post.likesResponse.liked}" th:href="@{/likes/like(postId=${post.id}, redirectAuthorId=${post.author.id}, redirectUrl=${post.url})}">♡</a>
												<span th:text="${post.likesResponse.likes}" class="ml-1">게시글 좋아요 수</span>
											</span>
											<div th:if="${loginMember} != null and ${loginMember.id} == ${post.author.id}" style="display:inline">
												<span class="mr-2"><a th:href="@{/posts/edit(postId=${post.id})}">수정</a></span>
												<form class="d-inline" th:action="@{/posts/delete(postId=${post.id})}" method="POST">
													<button class="btn" type="submit">삭제</button>
												</form>
											</div>
										</div>
										<!-- author, created_date, edit_button, delete_button End-->

										<!-- Tag -->
										<div class="bg-white rounded tags mb-5">
											<th:block th:each="tag : ${post.tags}">
												<a th:text="${tag.name}" th:href="@{/posts/{authorId} (authorId = ${post.author.id}, tag=${tag.name})}"></a>
											</th:block>
										</div>
										<!-- Tag End-->
										<!-- Content End -->

									</div>
								</div>
							</div>

							<hr class="mb-5" width="90%">

							<div class="col-lg-12 mb-5 px-5">
								<div class="posts-nav p-4 d-lg-flex d-md-flex justify-content-between">
									<a th:if="${post.beforePostUrl}" class="post-prev align-items-center d-md-flex bg-gray p-3" th:href="@{/posts/{authorId}/{url} (authorId=${post.beforePostAuthorId}, url=${post.beforePostUrl})}">
										<div class="hoUhWW mr-3">
											←
										</div>
										<div class="posts-prev-item mb-4 mb-lg-0">
											<span class="nav-posts-desc text-color">이전 포스트</span>
											<h6 class="nav-posts-title t-1" th:text="${post.beforePostTitle}">
												Donec consectetuer ligula <br>vulputate sem tristique.
											</h6>
										</div>
									</a>
									<a th:unless="${post.beforePostUrl}" class="post-prev align-items-center">
										<div class="posts-prev-item mb-4 mb-lg-0"></div>
									</a>

									<a th:if="${post.nextPostUrl}" class="post-prev align-items-center d-md-flex bg-gray p-3" th:href="@{/posts/{authorId}/{url} (authorId=${post.nextPostAuthorId}, url=${post.nextPostUrl})}">
										<div class="posts-prev-item mb-4 mb-lg-0">
											<span class="nav-posts-desc text-color">다음 포스트</span>
											<h6 class="nav-posts-title t-1" th:text="${post.nextPostTitle}">
												Donec consectetuer ligula <br>vulputate sem tristique.
											</h6>
										</div>
										<div class="hoUhWW ml-3">
											→
										</div>
									</a>
									<a th:unless="${post.nextPostUrl}" class="post-prev align-items-center">
										<div class="posts-prev-item mb-4 mb-lg-0"></div>
									</a>
								</div>
							</div>

							<!-- Comment -->
							<div class="col-lg-12">
								<!-- Comment Write -->
								<div class="comment-area card border-0 p-5">
									<h4 class="mb-4" th:text="${post.commentResponse.count} + '개의 댓글'">n개의 댓글</h4>
									<div class="col-lg-12 px-0 mb-5">
										<div th:if = "${loginMember} == null">
											<textarea disabled class="form-control mb-3" name="comment" cols="30" rows="3" placeholder="로그인이 필요합니다."></textarea>
											<div class="buttons-wrapper">
												<input disabled class="btn btn-primary px-3 py-2 rounded" type="submit" name="submit-contact" value="댓글 작성">
											</div>
										</div>
										<form th:unless = "${loginMember} == null" class="contact-form bg-white rounded" th:action="@{/comments (redirectUrl=${post.url}, redirectAuthorId=${post.author.id}, postId=${post.id}, authorId=${loginMember.id})}" method="POST">
											<textarea class="form-control mb-3" name="comment" id="comment" cols="30" rows="3" placeholder="댓글을 작성하세요"></textarea>

											<div class="buttons-wrapper">
												<input class="btn btn-primary px-3 py-2 rounded" type="submit" value="댓글 작성">
											</div>
										</form>
									</div>
								</div>

								<!-- Comment List -->
								<th:block th:each="commentDto : ${post.commentResponse.commentDtoList}">
									<div class="col-lg-12 col-md-6 mb-5">
										<div class="blog-item">
											<div class="blog-item-content bg-white p-4">
												<a th:text="${commentDto.authorNickName}" href="#" style="font-weight:bold; font-size:15px"></a>
												<p class="mb-4" th:text="${commentDto.createdDate}" style="font-size:14px; display:inline">댓글 생성 날짜</p>
												<div th:if ="${loginMember} != null and ${loginMember.id} == ${commentDto.authorId}" style="font-size:14px; display:inline; margin-left: 1rem!important;">
													<a th:href="@{/comments/edit(commentId=${commentDto.id}, redirectUrl=${post.url}, redirectAuthorId=${post.author.id})}">수정</a>
													<form class="d-inline" th:action="@{/comments/delete(commentId=${commentDto.id}, redirectUrl=${post.url}, redirectAuthorId=${post.author.id})}" method="POST">
														<button class="btn btn-link" type="submit">삭제</button>
													</form>
												</div>
												<p class="mb-4" th:text="${commentDto.content}" style="font-size:17px; color:#212529"></p>
											</div>
										</div>
									</div>
								</th:block>

							</div>

						</div>
					</div>
				</div>
			</div>
		</section>

		<!-- footer-->
		<footer th:insert="common/footer.html"></footer>
   
    </div>

	<!-- Essential Scripts -->
	<meta th:insert="common/scripts.html">

</body>
<script type="text/javascript">
  content = document.getElementById('getContent').value
  document.getElementById('content').innerHTML=content
</script>
</html>